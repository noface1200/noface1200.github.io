<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post Viewer</title>
</head>
<body>
    <div id="info"></div>
    <div id="content"></div>

    <script>

        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }
        var postNumber = getParameterByName('post');
        
        if (postNumber) {
            var contentFile = "/txtdb/posts.txt";
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        var contentBlocks = xhr.responseText.split('#');
                        var postContent = null;
                        for (var i = 0; i < contentBlocks.length; i++) {
                            var lines = contentBlocks[i].split('\n');
                            var title = "UNKNOWN";
                            var content = "";
                            for (var j = 0; j < lines.length; j++) {
                                var line = lines[j].trim();
                                if (line.startsWith("TITLE=")) {
                                    title = line.substring("TITLE=".length).trim();
                                } else if (line.startsWith("CONTENT=")) {
                                    content = line.substring("CONTENT=".length).trim();
                                }
                            }
                            if (i == postNumber && title !== "UNKNOWN") {
                                postContent = { title: title, content: content };
                                break;
                            }
                        }
                        if (postContent) {
                            var encodedContent = escapeHtml(postContent.content);
                            document.getElementById('info').innerHTML = "<h2 class='title'>Title: " + postContent.title + "</h2>";
                            document.getElementById('content').innerHTML = "<div class='content-text'>" + encodedContent + "</div>";
                        } else {
                            console.error("Post not found.");
                        }
                    } else {
                        console.error("Failed to load content.");
                    }
                }
            };
            xhr.open("GET", contentFile, true);
            xhr.send();
        } else {
            console.error("Post number not found in the query string.");
        }
        
        function escapeHtml(text) {
            var div = document.createElement('div');
            div.innerText = text;
            return div.innerHTML;
        }

    </script>
</body>
</html>



<div class="content" id="content"><div class="content-text">


</div></div>
